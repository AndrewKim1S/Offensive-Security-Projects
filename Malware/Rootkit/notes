################################# Rootkits ####################################

##### Linux Userland Rootkit
LD_PRELOAD
  - holds a list of user specified, ELF-shared objects. It enables users to 
    load these shared objects into a process's address space before any other
    shared library and prior to the execution of a program
  - Used with /etc/ld.so.preload file or LD_PRELOAD environment var
  - Overwrite existing functions used by dynamically linked programs

  Execution 
  - Must create interposed function for shared library function
    Compile to a shared object file: 
      gcc -shared -fPIC <file>
    Export LD_PRELOAD to location fo shred object:
      export LD_PRELOAD=/..<shared_obj>
    Check LD_PRELOAD environment var:
      echo $LD_PRELOAD
    Unset environment variable
      unset LD_PRELOAD


##### Linux Kernal Rootkit 
LKM - Syscall Hooking
	- Find the syscalltable and set the target syscall with function ptr of the 
		hijacked function. In order to this we may have to remove write protection
	- Create the hijacked function - version of the syscall. 
	- When exiting, set the syscalltable to original syscall function.

LKM - Keylogger
	- register keyboard notifier (callback function)
	- callback function can read keypress and values
	- When exiting unregister the keyboard notifier

	Execution
	compile with a makefile.
	Insert the module into the kernel with:
		sudo insmod <LKM_NAME>.ko
	Check kernel ring buffer for printk output:
		sudo dmesg 
	Remove kernel module 
		sudo rmmod <LKM_NAME>
	
