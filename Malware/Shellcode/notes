Shellcoding Notes


Shellcode is machine code - with conditions
	- Cannot use direct offsets to strings
	- Do not know the addresses of functions (ex printf)
	- Must avoid specific bytes such as NULL bytes (0x00)

__________________________________________________________________________________ 
Linux 
	- Linux can use system calls with (int 0x80 or syscall)
		- syscall for (x64):  https://x64.syscall.sh/
		- info:  https://en.wikibooks.org/wiki/X86_Assembly/Interfacing_with_Linux

		- mov syscall number into rax or eax
		- call syscall or int 0x80

	1. Write the assembly code 
		- define global entry point:   gloabl _start
		- define .text section:        section .text
		- set entry point:             _start:
	2. Assemble and Link the program
		$ nasm -f elf64 <file.asm> -o <output.o>
		$ ld <output.o> -o <exec>
	3. Get machine code
		$ objdump -d <exec>

	* Remove NULLS (00) by avoiding mov instr (can use add or xor instead)
	* Can place strings on the stack if necessary to keep the shellcode position independent
	* Parse machine code:
		$ objdump -d a.out | awk '{$1=""; print $0}' | grep -oE ' ([0-9a-f][0-9a-f] |[0-9a-f][0-9a-f]$)+'
__________________________________________________________________________________
Windows 
	- Windows does not provide a syscall interface for direct use by user space apps
		Instead Windows uses (NT kernel calls) for sys calls and WinAPI which is a high
		level wrapper for system calls

